# 规则：生成产品需求文档（PRD）

## 目标

指导智能助手基于用户的初始需求，生成清晰、可执行的 PRD（Markdown 格式），让初级开发者也能理解并实现。

## 流程

1. **接收初始需求：** 用户提供功能/需求的简要描述。
2. **提出澄清问题：** 在写 PRD 前，必须只问最关键的 3–5 个问题，用于补齐影响 PRD 清晰度的缺口。重点理解“做什么/为什么”，而不是“怎么做”。问题必须以编号 + 选项（A/B/C…）形式给出，并允许用户用最少输入回复（见下文“提问格式要求”）。
3. **等待用户回答并确认默认值：** 若用户回复字母数量少于题目数量，剩余题目按“推荐”选项处理（除非用户明确说不想默认）。确认完后再进入 PRD 生成。
4. **生成 PRD：** 基于初始需求与用户回答，按下述结构生成 PRD。
5. **保存 PRD：** 将文件保存为 `/docs/PRD.md`。

## 重要澄清：澄清问题写在哪里？

- **澄清问题必须先在对话中提出**（也就是你现在看到的助手回复里），用于让用户做选择/补充信息。
- **澄清问题不得写进最终产物 `docs/PRD.md`**：`PRD.md` 只包含确认后的需求与剩余未决项（放在 `Open Questions` 章节），不应包含“请回答 A/B/C”这类提问内容。
- 若用户要求输出文件名/路径与本规则冲突（例如要写成 `RPD.md`），必须先在对话中向用户确认采用哪一种输出规范，再写文件，避免误写/误覆盖。

## 澄清问题（指南）

只问最关键的问题，且仅在信息确实缺失时提问。常见补充方向：

- **问题/目标：** 若不清晰 → “此功能为用户解决什么问题？”
- **核心功能：** 若描述模糊 → “用户需要完成哪些关键动作？”
- **范围/边界：** 若范围过大 → “明确哪些不做？”
- **成功标准：** 若缺失 → “如何判断实现成功？”
- **域名与关键词：** 若缺失 → “主要域名（或拟使用域名）是什么？用于文案/标题/SEO 的 5–12 个关键词或短语有哪些？”
- **目标地区/语言变体：** 若缺失 → “面向的地区/语言变体（如美式/英式）是什么？”

**重要：** 仅在无法从初始需求合理推断时提问。优先提问对 PRD 清晰度影响最大的点。

### 提问格式要求

- **问题必须编号**（1, 2, 3…）
- **每个问题必须提供 A/B/C/D… 选项**（选项数量控制在 2–4 个）
- **每题必须给推荐与理由**：
  - `推荐：X`（只给一个）
  - `理由：……`（一句话即可，尽量精简）
- **必须在问题开头声明回答方式**：
  - 允许用户按顺序只回复选项字母序列，例如：`ACB` 代表 `1A, 2C, 3B`
  - 若用户回复字母数量少于题目数量，剩余题目按“推荐”选项处理（除非明确说不想默认）
- 仍支持显式回复：`1A, 2C, 3B`

### 示例格式

```
请按顺序只回复选项字母，例如 ACB = 1A 2C 3B；若你只回 1–2 个字母，剩余题目我会按“推荐”处理。

1. 该功能的主要目标是什么？
   A. 改善新用户上手
   B. 提升留存
   C. 降低支持成本
   D. 增加收入
   推荐：A
   理由：更利于定义交互与成功标准

2. 目标用户是谁？
   A. 仅新用户
   B. 仅老用户
   C. 全部用户
   D. 仅管理员
   推荐：C
   理由：先做通用版本更稳

3. 期望上线时间？
   A. 紧急（1–2 周）
   B. 高优先级（3–4 周）
   C. 标准（1–2 个月）
   D. 未来再做（3 个月以上）
   推荐：C
   理由：便于兼顾质量与迭代
```

## PRD 结构

PRD 应包含以下章节（可微调顺序，但建议保持整体结构）：

1. **Introduction/Overview：** 简述功能与问题，说明目标。
2. **Domain & Primary Keywords：** 主要域名与关键词（用于文案/标题/SEO）。
3. **Goals：** 列出可衡量的目标。
4. **User Stories：** 用户故事。
5. **Glossary（术语表）：** 用于统一内部术语、规格文案与 UI 文案。
   - **Term（英文内部术语）**：代码/规格/任务统一用的英文名
   - **中文解释**：含义与使用场景
   - **UI 文案（外显）**：界面显示的文字

   表格示例：

   | Term        | 中文解释     | UI 文案（外显）            |
   | ----------- | ------------ | -------------------------- |
   | Search Mode | 搜索模式     | Search Mode                |
   | Copy Mode   | 复制模式     | Copy Mode                  |
   | Link Guard  | 链接禁用功能 | Disable links on this site |

   Glossary 使用规则：
   - 内部统一使用 Term；UI 一律使用「UI 文案」
   - 新概念必须先补 Glossary
   - 术语冲突需先澄清再新增

6. **Interaction Flows（交互路径）：** 用户视角的步骤流程，仅描述界面层响应，不写实现细节。
7. **Functional Requirements：** 具体功能与业务规则，使用可实现、可验证的语句并编号。
8. **Non-Goals (Out of Scope)：** 明确不做的范围。
9. **Design Considerations (Optional)：** 设计/组件/样式指引。
10. **UI Reference Code（UI 参考代码，必留占位）**：
   - 用于粘贴 UI 参考实现（已有页面/组件/布局代码），让后续 AI 做网站时“按参考实现”，而不是盲猜 UI 结构；
   - 默认放 `TODO` 占位；当你有代码时直接贴进来即可；
   - 若提供了参考代码，后续实现应优先复用其信息架构/组件结构/交互模式，并指出哪些部分仍是 `TODO`。
11. **Technical Considerations (Optional)：** 技术约束或依赖。
12. **Success Metrics：** 成功衡量指标。
13. **Open Questions：** 未决问题。

## 目标读者

PRD 的主要读者是**初级开发者**，要求明确、无歧义。

## 输出

- **格式：** Markdown（`.md`）
- **位置：** `/docs/`
- **文件名：** `PRD.md`
- **文档角色说明：** 在 `PRD.md` 标题下方必须加入：

  `文档角色说明：本文件定义「做什么、怎么运作」——功能逻辑、交互流程与业务规则；视觉细节统一收敛在设计规范 src\\styles（按项目实际目录为准）。`

- **语言规范说明：** PRD 顶部需简要说明语言规范（直接引用，不再提 `rules.md`）。
- **UI 参考代码占位（必需）：** PRD 中必须包含 `UI Reference Code（UI 参考代码）` 章节，并提供可直接粘贴的代码块占位，例如：

  ```md
  ## UI Reference Code（UI 参考代码）

  > TODO：把现有 UI 参考实现贴在这里（例如：已有页面/组件/布局代码）。
  > 后续实现应优先参考这份代码的结构与交互，而不是自行假设。

  ```tsx
  // TODO: paste UI reference code here
  ```
  ```

## 最终约束

1. 不要开始实现，只生成文档
2. 必须先提问澄清问题
3. 必须等待用户回答（或明确确认使用“推荐”默认值）后再生成 `docs/PRD.md`
4. 澄清问题不得出现在最终 `docs/PRD.md` 中；剩余不确定项写入 `Open Questions`
