# 规则：从需求生成任务清单

## 目标

指导智能助手根据用户需求、功能请求或现有文档，生成清晰的 Markdown 任务清单，便于开发者按步骤实施。

## 输出

- **格式：** Markdown（`.md`）
- **位置：** `/docs/`
- **文件名：** `tasks.md`
- **文档角色说明：** 生成 `tasks.md` 时，**必须**在主标题之后添加「文档角色说明」，用 1–3 句话说明：
  - 本文件用于跟踪当前项目的开发任务与进度，是执行层的操作清单；
  - 行为逻辑与需求细节以 `docs/PRD.md` 为准，视觉样式与交互细节以 `src\\styles` 为准；
  - 当任务与上述规格文档发生冲突时，需要先确认并更新规格文档，再调整任务列表，**不得通过直接修改任务规避规格要求**。

## 流程

1. **接收需求：** 用户提供功能请求、任务描述或指向现有文档。
2. **分析需求：** 智能助手分析功能需求、用户目标与实现范围。
3. **阶段 1：生成父任务：** 基于需求分析，生成高层任务（不含子任务）。父任务数量通常 4–6 个。将父任务按指定格式发给用户，并提示：“我已生成高层任务，是否继续生成子任务？回复 ‘Go’ 继续。”
4. **等待确认：** 暂停并等待用户回复 “Go”。
5. **阶段 2：生成子任务：** 用户确认后，为每个父任务拆分可执行子任务，确保覆盖实现细节。
6. **识别相关文件：** 列出可能需要创建或修改的文件，必要时包含测试文件。
7. **生成最终输出：** 合并父任务、子任务、相关文件与说明，形成最终文档。
8. **保存任务清单：** 写入 `/docs/tasks.md`。

## 输出格式

生成的任务清单**必须**遵循以下结构：

- 父任务（1.0、2.0…）使用 Markdown 三级标题（`### 1.0 xxx`），**不要**把父任务本身做成复选框；
- 子任务使用 `- [ ]` 列表项，归属于对应父任务标题之下；
- **不要创建 0.0 任务**。
- **必须在 `tasks.md` 中加入《开发规范与任务清单管理》章节**（内容按本文件该章节执行）。

```markdown
## 相关文件

- `path/to/potential/file1.ts` - 说明该文件与任务的关系（例如：主组件入口）。
- `path/to/file1.test.ts` - `file1.ts` 的单元测试。
- `path/to/another/file.tsx` - 说明该文件与任务的关系（例如：表单提交 API）。
- `path/to/another/file.test.tsx` - `another/file.tsx` 的单元测试。
- `lib/utils/helpers.ts` - 工具函数或共享逻辑。
- `lib/utils/helpers.test.ts` - `helpers.ts` 的单元测试。

## 任务

### 1.0 父任务标题

- [ ] 1.1 [子任务描述 1.1]
- [ ] 1.2 [子任务描述 1.2]

### 2.0 父任务标题

- [ ] 2.1 [子任务描述 2.1]

### 3.0 父任务标题（若为纯结构或配置类任务，可无需子任务）
```

## 开发规范与任务清单管理

**文档规范**

- 需求文档：实现功能时必须严格按照 `docs/PRD.md` 中的具体要求执行。
- 设计规范：界面样式与交互必须严格遵循 `src\\styles` 中的设计规范。

**沟通与执行**

- 遇到文档歧义或需求冲突时，必须暂停并确认，不得自行臆断。
- 界面实现若与原型或设计规范不一致，必须先确认后再实现。

**完成协议**

1. **一次只做一个子任务：** 在得到用户 “yes / y” 确认前，**不要**开始下一个子任务。
2. 当完成某个 **子任务** 时，立即将该条目标记为完成：把 `- [ ]` 改为 `- [x]`。
3. 当某个父任务下的所有子任务均为 `[x]` 时，可以在父任务标题前追加简单标记（例如在标题行最前面加上「✅ 」），无需再为父任务单独使用复选框。

**清单维护**

- 在实施过程中，如发现新的必要任务，应在 `tasks.md` 中补充相应条目。
- 维护 `相关文件`：列出每一个被创建或修改的文件，并为每个文件提供一句用途说明。
